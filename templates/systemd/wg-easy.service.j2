# {{ ansible_managed }}
[Unit]
Description=The easiest way to run WireGuard VPN with Web-based Admin UI
After=network.target

[Service]
Environment=DEBUG=Server,Wireguard
Environment=PASSWORD={{ wiregaurd_easy_password }}
Environment=LISTEN_IP={{ wiregaurd_easy_listen_ip }}
Environment=PORT={{ wiregaurd_easy_port }}
Environment=WG_DEFAULT_ADDRESS={{ wiregaurd_easy_wg_default_address }}
Environment=WG_DEFAULT_DNS={{ wiregaurd_easy_wg_default_dns }}
Environment=WG_HOST={{ wiregaurd_easy_wg_host }} 
Environment=WG_PORT={{ wiregaurd_easy_wg_port }} 
Environment=WG_PATH={{ wireguard_easy_config_path }}
Environment='WG_POST_UP=iptables -t nat -A POSTROUTING -s {{ wiregaurd_easy_wg_default_address }} -o {{ wiregaurd_easy_host_interface }} -j MASQUERADE;\
iptables -A INPUT -p udp -m udp --dport {{ wiregaurd_easy_wg_port }}  -j ACCEPT;\
iptables -A FORWARD -i wg0 -j ACCEPT;\
iptables -A FORWARD -o wg0 -j ACCEPT;\
'

User={{ wiregaurd_easy_user }}
WorkingDirectory={{ wiregaurd_easy_bin_path }}/app
ExecStart=node server.js

[Install]
WantedBy=default.target
